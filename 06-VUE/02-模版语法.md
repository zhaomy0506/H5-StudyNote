# 一、插值语法

Vue模版语法分为两类:插值语法/指令语法

### 插值语法

功能:用于解析标签体内容

写法:`{{xxx}}`,内部`xxx`要写成js表达式,可以读取到data中所有的属性

# 二、指令语法

> 备注:Vue中有很多指令,且都是`v-???`形式

## 目录:

1. [数据绑定](#1.数据绑定)
   1. `v-bind:xxx` 单项绑定解析表达式,简写`:xxx`
   2. `v-model` 双向数据绑定

2. [事件绑定](#2.事件绑定)
   1. `v-on` 当定事件监听,简写`@xxx`

3. [条件渲染](#3.条件渲染指令)
   1. `v-if` 条件渲染(动态控制节点是否存在)
   2. `v-else-if`/`v-else`条件渲染,配合`v-if`使用
   3. `v-show` 条件渲染(动态控制节点是否展示)

4. [列表渲染](#4.列表渲染指令)
   1. `v-for` 遍历数组/对象/字符串

5. [内容替换](#5.补充指令)
   1. `v-text` 替换所在标签的文本
   2. `v-html` 替换所在标签内的所有内容,支持HTML语法

6. 其他补充
   1. `v-cloak` 用于解决在Vue实例编译完成之前，在初始渲染时显示模板表达式的问题。
   2. `v-once` 可用于标记某个元素，使其只在初始渲染时渲染一次
   3. `v-pre` 用于跳过元素和其子元素的编译过程

## 1.数据绑定

vue中有两种数据绑定的方式:

1. 单项绑定:`v-bind`,数据只能从data流向页面
   - `v-bind:属性名="xxx"`,简写`:属性名="xxx"`
   
   - `xxx`需要写成js表达式,可以动态指定任意一个属性的属性值
2. 双向绑定:`v-model`,数据从data流向页面,还可以从页面流向data
   - `v-model:value="xxx"`,简写`v-model="xxx"`,因为其默认收集value值
   
   - `v-model`指令只能用于表单类元素上(如:input,select...)

3. `v-model`指令的三个修饰符:
   1. `.lazy` 失去焦点后再收集数据
   2. `.number` 输入字符串转为有效的数字
   3. `.trim` 去除首位空格

### 收集表单数据

1. 对于文本框`（input type=“text”）`：使用`v-model`指令可以收集输入的值，即`value`属性的值。

2. 对于单选框`（input type=“radio”）`：需要给每个单选框设置一个`value`属性，`v-model`指令将会收集选中单选框的`value`值。

3. 对于复选框`（input type=“checkbox”）`：
   1. 没有配置input的value属性，`v-model`指令将会收集checkbox的checked属性的值（true/false）。
   2. 配置了input的value属性：
      - `v-model`的初始值为非数组,那么收集的就是checked的值
      - `v-model`的初始值是数组,那么收集的就是value值

## 2.事件绑定

1. 使用`v-on:xxx`简写`@xxx`,都可以绑定事件,`xxx`为事件名

2. 事件的回调需要配置在`methods`对象中,最终会出现在Vue实例对象上

3. `methods`中配置的函数,都是被Vue所管理的函数,this指向Vue实例

4. `@click='demo'`与`@click='demo($event)'`,效果一致,后者可以传参

### 事件修饰符(总共六个)

1. `.prevent` 阻止默认事件(*)
2. `.stop` 阻止事件冒泡(*)
3. `.once` 事件只能被触发一次(*)
4. `.capture` 事件捕获阶段触发事件
5. `.self` 只有event.target是当前操作的Dom时,才会触发事件
6. `.passive` 事件的默认行为立即执行,无需等待事件回调执行完毕直接执行
7. `.native`让组件触发原生事件

### 键盘事件修饰符:

Vue中给常见的按键起了别名

1. `enter` => 回车
2. `delete` => 删除(捕获回车和delete)
3. `esc` => 退出
4. `space` => 空格
5. `tab` => 换行(特殊,需配合keydown使用)
6. `up`/`down`/`left`/`right` => 上下左右

Vue未提供别名的按键,可以使用按键的key值绑定,需注意kebab-case(短横线命名法)

系统修饰键(用法特殊),ctrl,alt,shift,win

1. 配合keyup使用,按下修饰键的同时,需要配合其它按键使用
2. 配合keydown使用,正常触发

> ***修饰符可以链式调用***
>
> 需要自定义别名,可以添加配置,`Vue.config.keyCodes.xxx`

## 3.条件渲染指令

1. v-if,可以配合`<template>`标签使用

   1. `v-if='表达式'`
   2. `v-else-if='表达式'`
   3. `v-else='表达式'`

   适用于:切换频率较低的场景

   特点:不展示的DOM元素直接被移除

> v-if可以和v-else-if和v-else配合使用,但要求结构不能被打断

2. v-show

   `v-show='表达式'`

   适用于:切换频率较高的场景

   特点:不展示的DOM元素未被移除,仅被隐藏掉

## 4.列表渲染指令

v-for指令

1. 用于展示列表数据

2. 语法:

   - `v-for='(item,index) in xxx' :key:'yyy'`

   - `v-for='(item,index) of xxx' :key:'yyy'`

3. 可以遍历数据:数组,对象,字符串,指定次数

### v-for中的key

1. 虚拟DOM中的key作用

   key是虚拟DOM对象的标识,当状态中的数据发生变化时,Vue会根据新数据生成新的虚拟DOM

   随后使用新虚拟DOM与旧虚拟DOM进行差异比较,规则如下:

2. 对比规则:

   1. 旧虚拟DOM中找到了与新虚拟DOM相同的key

      1. 若虚拟DOM中内容不变,直接使用之前的真实DOM
      2. 若虚拟DOM中改变,则生成新真实DOM,随后替换掉之前页面的真实DOM

   2. 旧虚拟DOM中未找到与新虚拟DOM相同的key

      则直接创建新的真实DOM,随后渲染到页面

3. 用index作为key可能会引发的问题

   1. 若对数据进行:逆序添加,逆序删除等破坏性操作:

      会产生没有必要的真实DOM更新 => 页面展示效果无问题,但效率低下

   2. 若结构中还包含输入类的DOM

      会产生错误的DOM更新 => 页面效果会出现问题

4. 开发中如何选择key?

   1. 最好使用每条数据的唯一标识,比如id,手机号,身份证号,学号等唯一值

   2. 若不存在对数据的逆序添加、删除等破坏性操作，仅用于页面渲染列表用于展示

      也可以使用index作为key，这样是没有问题的

## 5.补充指令

### `v-html`

作用:向指定节点中渲染包含html结构的内容

与插值语法的区别:

1. v-html会替换掉节点中的所有的内容,{{xxx}}则不会
2. v-html可以识别html结构

> ***严重注意:v-html有安全性问题!!!***
>
> 1. 在网站上动态渲染任意HTML是非常危险的行为,容易导致XSS共攻击
> 2. 一定要在可信的内容中使用v-html,永远不要用在用户提交的内容上

### `v-cloak`

v-cloak指令(没有值),配合css使用

1. 本质是一个特殊属性,Vue实例创建完毕并接管后,会删掉v-cloak属性
2. 使用css配合v-cloak可以解决网速慢时页面展示出{{xxx}}的问题

### `v-once`

1. v-once 所在节点在初次动态渲染后,就视为静态内容了
2. 以后数据的变化不会引起v-once所在的结构的更新,可以用于性能优化

### `v-pre`

1. 该指令跳过其所在节点的编译过程
2. 可利用它跳过:没有使用指令语法,没有使用插值语法的节点,会加快编译

# 三、自定义指令

>1. 指令定义时不需要加 `v-` 前缀,但使用时必须加上 `v-` 前缀
>2. 如果指令名是多个单词，要使用 `kebab-case` 命名方式，不要使用 `camelCase` 命名方式

## 1.局部自定义指令

在局部自定义指令中，vm配置对象的 `directives` 配置中

```js
new Vue({
    directives:{
        指令名:配置对象/回调函数
    }
})
```

## 2.全局自定义指令

在全局自定义指令中，你可以使用 `Vue.directive` 方法来定义指令

```js
Vue.directive(指令名,配置对象/回调函数)
```

### 配置对象常用的三个回调函数

1. `bind`:指令与元素成功绑定时调用
2. `inserted`:指令所在元素被插入页面时调用
3. `update`:指令所在模版结构被重新解析时调用

### 回调函数参数

1. `element`：所添加的真实 DOM 元素
2. `binding`：一个对象，
   1. `banding.value` 传入的指令的值
   2. `banding.oldvalue` 旧值

